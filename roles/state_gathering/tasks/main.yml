---
- collections:
    - ansible.builtin
  block:
    - name: Test ssh connection on configured port
      wait_for_connection:
        timeout: 10
      register: state_gathering_connection_test_result

    # TODO: To apply gitops practices, this needs to be true if we're running on the remote host
    # Either with local or some other plugin
    - name: Setting state variable
      set_fact:
        setup_completed: "{{ state_gathering_connection_test_result is succeeded }}"
  ignore_errors: True
